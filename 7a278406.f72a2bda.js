(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{111:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return O}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=a.a.createContext({}),p=function(e){var t=a.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},s=function(e){var t=p(e.components);return a.a.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,i=b(e,["components","mdxType","originalType","parentName"]),s=p(n),m=r,O=s["".concat(l,".").concat(m)]||s[m]||d[m]||o;return n?a.a.createElement(O,c(c({ref:t},i),{},{components:n})):a.a.createElement(O,c({ref:t},i))}));function O(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=m;var c={};for(var b in t)hasOwnProperty.call(t,b)&&(c[b]=t[b]);c.originalType=e,c.mdxType="string"==typeof e?e:r,l[1]=c;for(var i=2;i<o;i++)l[i]=n[i];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},87:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return b})),n.d(t,"default",(function(){return p}));var r=n(3),a=n(7),o=(n(0),n(111)),l={id:"rest",title:"API Rest Controllers",sidebar_label:"API Rest Controllers"},c={unversionedId:"rest",id:"rest",isDocsHomePage:!1,title:"API Rest Controllers",description:"Introdu\xe7\xe3o",source:"@site/docs/rest.md",slug:"/rest",permalink:"/onyx-theme-doc/docs/rest",editUrl:"https://github.com/andremacola/onyx-theme-doc/edit/master/website/docs/rest.md",version:"current",sidebar_label:"API Rest Controllers",sidebar:"Sidebar",previous:{title:"Controllers e Views",permalink:"/onyx-theme-doc/docs/controllers"},next:{title:"Views - Twig Templates",permalink:"/onyx-theme-doc/docs/views"}},b=[{value:"Introdu\xe7\xe3o",id:"introdu\xe7\xe3o",children:[]},{value:"Funcionamento",id:"funcionamento",children:[]},{value:"Registrando",id:"registrando",children:[]},{value:"Par\xe2metros e M\xe9todos",id:"par\xe2metros-e-m\xe9todos",children:[]},{value:"Criando um REST API Controller",id:"criando-um-rest-api-controller",children:[]},{value:"M\xe9todos Helpers",id:"m\xe9todos-helpers",children:[{value:"<code>route()</code>",id:"route",children:[]},{value:"<code>rest_response()</code>",id:"rest_response",children:[]}]}],i={rightToc:b};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},i,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"introdu\xe7\xe3o"},"Introdu\xe7\xe3o"),Object(o.b)("p",null,"O Onyx oferece uma simples classe ",Object(o.b)("inlineCode",{parentName:"p"},"RestController")," para facilitar a escrita da ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/rest-api/"}),"REST API's")," do WordPress. Veja mais informa\xe7\xf5es na fun\xe7\xe3o ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/reference/functions/register_rest_route/"}),"register_rest_route()")," e em ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/rest-api/extending-the-rest-api/adding-custom-endpoints/"}),"custom endpoints")),Object(o.b)("hr",null),Object(o.b)("h2",{id:"funcionamento"},"Funcionamento"),Object(o.b)("p",null,"Todas os controllers para a REST API s\xe3o criados dentro da pasta ",Object(o.b)("inlineCode",{parentName:"p"},"./core/app/Api"),", tem como seu namespace ",Object(o.b)("inlineCode",{parentName:"p"},"Onyx\\Controllers")," e extendem a classe ",Object(o.b)("inlineCode",{parentName:"p"},"Onyx\\RestController"),"."),Object(o.b)("hr",null),Object(o.b)("h2",{id:"registrando"},"Registrando"),Object(o.b)("p",null,"Ap\xf3s a cria\xe7\xe3o do controller, \xe9 necess\xe1rio registr\xe1-lo em ",Object(o.b)("inlineCode",{parentName:"p"},"./core/config/app.php")," como no exemplo abaixo."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-php"}),"return [\n  \\Onyx\\Controllers\\ExampleRestController::class,\n  \\Onyx\\Controllers\\MyOtherRestController::class,\n];\n")),Object(o.b)("hr",null),Object(o.b)("h2",{id:"par\xe2metros-e-m\xe9todos"},"Par\xe2metros e M\xe9todos"),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Vari\xe1vel"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Tipo"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Obrigat\xf3rio"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"$namespace")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("em",{parentName:"td"},"string/array")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Namespace da Rota"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")))),Object(o.b)("p",null,"\xc9 obrigat\xf3rio setar a propriedade ",Object(o.b)("inlineCode",{parentName:"p"},"namespace")," da classe assim como inicializar o m\xe9todo ",Object(o.b)("inlineCode",{parentName:"p"},"$this->initialize()")," como podemos ver no exemplo a seguir."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"M\xe9todos Helpers")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"#route"}),Object(o.b)("inlineCode",{parentName:"a"},"RestController->route()"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"#response"}),Object(o.b)("inlineCode",{parentName:"a"},"RestController->response()")))),Object(o.b)("hr",null),Object(o.b)("h2",{id:"criando-um-rest-api-controller"},"Criando um REST API Controller"),Object(o.b)("p",null,"Neste exemplo criaremos o endpoint ",Object(o.b)("inlineCode",{parentName:"p"},"/(api|wp-json)/onyx/v1/example")," com os m\xe9todos POST e GET."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-php"}),"namespace Onyx\\Controllers;\n\nuse \\Onyx\\RestController;\n\nclass ExampleRestController extends RestController {\n\n  /**\n   * The namespace for the rest endpoint api\n   *\n   * @var string\n   */\n  protected $namespace = 'onyx/v1';\n\n  /**\n   * Constructor\n   *\n   * @return void\n   */\n  public function __construct() {\n    $this->initialize();\n  }\n\n  /**\n   * Register routes\n   *\n   * @return void\n   */\n  public function register_routes() {\n    // register examples routes\n    $this->route( 'POST', '/example', 'generic_callback' );\n    $this->route( 'GET', '/example', 'generic_callback' );\n  }\n\n  /**\n   * Generic Callback\n   *\n   * @param \\WP_REST_Request $req\n   * @return \\WP_REST_Response|mixed\n   */\n  public function generic_callback( \\WP_REST_Request $req ) {\n    return rest_ensure_response( $req->get_params(), 200 );\n  }\n")),Object(o.b)("hr",null),Object(o.b)("h2",{id:"m\xe9todos-helpers"},"M\xe9todos Helpers"),Object(o.b)("h3",{id:"route"},Object(o.b)("inlineCode",{parentName:"h3"},"route()")),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Vari\xe1vel"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Tipo"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Descri\xe7\xe3o"),Object(o.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Obrigat\xf3rio"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"$method")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("em",{parentName:"td"},"WP_Rest_Server/mixed")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"(GET, POST, PUT, PATCH, DELETE)"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"$route")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("em",{parentName:"td"},"string")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"O Endpoint da rota"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"$callback")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("em",{parentName:"td"},"callable")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"M\xe9todo do controller callback para executar"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"$options")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("em",{parentName:"td"},"array")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Op\xe7\xf5es do endpoint"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2718")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("inlineCode",{parentName:"td"},"$override")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(o.b)("em",{parentName:"td"},"bool")),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Substituir rota existente. Padr\xe3o: falso"),Object(o.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2718")))),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"@return bool"),Object(o.b)("br",{parentName:"p"}),"\n",Object(o.b)("inlineCode",{parentName:"p"},"@throws \\Exception")," Se n\xe3o existir ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"#par%C3%A2metros-e-m%C3%A9todos"}),Object(o.b)("inlineCode",{parentName:"a"},"$namespace"))),Object(o.b)("h3",{id:"rest_response"},Object(o.b)("inlineCode",{parentName:"h3"},"rest_response()")),Object(o.b)("p",null,"Alias para ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/reference/classes/wp_rest_response/"}),"\\WP_REST_Response")))}p.isMDXComponent=!0}}]);