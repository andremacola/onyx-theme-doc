(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{157:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return o})),n.d(t,"default",(function(){return p}));var r=n(2),a=n(9),l=(n(0),n(179)),c={id:"rest",title:"Rest API Controllers",sidebar_label:"Rest API Controllers"},b={id:"rest",isDocsHomePage:!1,title:"Rest API Controllers",description:"Introduction",source:"@site/docs/rest.md",permalink:"/onyx-theme-doc/en/docs/rest",editUrl:"https://github.com/andremacola/onyx-theme-doc/edit/master/website/docs/rest.md",sidebar_label:"Rest API Controllers",sidebar:"Sidebar",previous:{title:"Controllers and Views",permalink:"/onyx-theme-doc/en/docs/controllers"},next:{title:"Views - Twig Templates",permalink:"/onyx-theme-doc/en/docs/views"}},o=[{value:"Introduction",id:"introduction",children:[]},{value:"Registering",id:"registering",children:[]},{value:"Parameters and Methods",id:"parameters-and-methods",children:[]},{value:"Creating a REST API Controller",id:"creating-a-rest-api-controller",children:[]},{value:"Methods Helpers",id:"methods-helpers",children:[{value:"<code>route()</code>",id:"route",children:[]},{value:"<code>rest_response()</code>",id:"rest_response",children:[]}]}],i={rightToc:o};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(l.b)("wrapper",Object(r.a)({},i,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("h2",{id:"introduction"},"Introduction"),Object(l.b)("p",null,"Onyx offers a simple ",Object(l.b)("inlineCode",{parentName:"p"},"RestController")," class to facilitate the WordPress's ",Object(l.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/rest-api/"}),"REST API's"),". See more information at ",Object(l.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/reference/functions/register_rest_route/"}),"register_rest_route()")," and ",Object(l.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/rest-api/extending-the-rest-api/adding-custom-endpoints/"}),"custom endpoints")),Object(l.b)("p",null,"All REST API controllers are created inside the ",Object(l.b)("inlineCode",{parentName:"p"},"./core/app/Api")," folder, with the namespace ",Object(l.b)("inlineCode",{parentName:"p"},"Onyx\\Controllers")," and extend the ",Object(l.b)("inlineCode",{parentName:"p"},"Onyx\\RestController")," class."),Object(l.b)("hr",null),Object(l.b)("h2",{id:"registering"},"Registering"),Object(l.b)("p",null,"After creating the controller, it is necessary to register it in ",Object(l.b)("inlineCode",{parentName:"p"},"./core/config/rest.php")," as in the example below."),Object(l.b)("pre",null,Object(l.b)("code",Object(r.a)({parentName:"pre"},{className:"language-php"}),"namespace Onyx\\Controllers;\n\nreturn [\n  ExampleRestController::class,\n  MyOtherRestController::class,\n];\n")),Object(l.b)("hr",null),Object(l.b)("h2",{id:"parameters-and-methods"},"Parameters and Methods"),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Variable"),Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Type"),Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Description"),Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Required"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("inlineCode",{parentName:"td"},"$namespace")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("em",{parentName:"td"},"string/array")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Route Namespace"),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")))),Object(l.b)("p",null,"It is required to set the ",Object(l.b)("inlineCode",{parentName:"p"},"namespace")," property as well as initialize the ",Object(l.b)("inlineCode",{parentName:"p"},"$this->initialize()")," method as we can see in the following example."),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Helpers Methods")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(r.a)({parentName:"li"},{href:"#route"}),Object(l.b)("inlineCode",{parentName:"a"},"RestController->route()"))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("a",Object(r.a)({parentName:"li"},{href:"#response"}),Object(l.b)("inlineCode",{parentName:"a"},"RestController->response()")))),Object(l.b)("hr",null),Object(l.b)("h2",{id:"creating-a-rest-api-controller"},"Creating a REST API Controller"),Object(l.b)("p",null,"In this example we will create the endpoint ",Object(l.b)("inlineCode",{parentName:"p"},"/(api|wp-json)/onyx/v1/example")," with the POST and GET methods."),Object(l.b)("pre",null,Object(l.b)("code",Object(r.a)({parentName:"pre"},{className:"language-php"}),"namespace Onyx\\Controllers;\n\nuse \\Onyx\\RestController;\n\nclass ExampleRestController extends RestController {\n\n  /**\n   * The namespace for the rest endpoint api\n   *\n   * @var string\n   */\n  protected $namespace = 'onyx/v1';\n\n  /**\n   * Constructor\n   *\n   * @return void\n   */\n  public function __construct() {\n    $this->initialize();\n  }\n\n  /**\n   * Register routes\n   *\n   * @return void\n   */\n  public function register_routes() {\n    // register examples routes\n    $this->route( 'POST', '/example', 'generic_callback' );\n    $this->route( 'GET', '/example', 'generic_callback' );\n  }\n\n  /**\n   * Generic Callback\n   *\n   * @param \\WP_REST_Request $req\n   * @return \\WP_REST_Response|mixed\n   */\n  public function generic_callback( \\WP_REST_Request $req ) {\n    return rest_ensure_response( $req->get_params(), 200 );\n  }\n")),Object(l.b)("hr",null),Object(l.b)("h2",{id:"methods-helpers"},"Methods Helpers"),Object(l.b)("h3",{id:"route"},Object(l.b)("inlineCode",{parentName:"h3"},"route()")),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Variable"),Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Type"),Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Description"),Object(l.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Required"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("inlineCode",{parentName:"td"},"$method")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("em",{parentName:"td"},"WP_Rest_Server/mixed")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"(GET, POST, PUT, PATCH, DELETE)"),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("inlineCode",{parentName:"td"},"$route")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("em",{parentName:"td"},"string")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Route endpoint"),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("inlineCode",{parentName:"td"},"$callback")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("em",{parentName:"td"},"callable")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Controller callback method to execute"),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2714")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("inlineCode",{parentName:"td"},"$options")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("em",{parentName:"td"},"array")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Endpoint options"),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2718")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("inlineCode",{parentName:"td"},"$override")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(l.b)("em",{parentName:"td"},"bool")),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Replace existing route. Default: falso"),Object(l.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"\u2718")))),Object(l.b)("p",null,Object(l.b)("inlineCode",{parentName:"p"},"@return bool"),Object(l.b)("br",{parentName:"p"}),"\n",Object(l.b)("inlineCode",{parentName:"p"},"@throws \\Exception")," If the ",Object(l.b)("a",Object(r.a)({parentName:"p"},{href:"#par%C3%A2metros-e-m%C3%A9todos"}),Object(l.b)("inlineCode",{parentName:"a"},"$namespace"))," does not exist"),Object(l.b)("h3",{id:"rest_response"},Object(l.b)("inlineCode",{parentName:"h3"},"rest_response()")),Object(l.b)("p",null,"Alias for ",Object(l.b)("a",Object(r.a)({parentName:"p"},{href:"https://developer.wordpress.org/reference/classes/wp_rest_response/"}),"\\WP_REST_Response")))}p.isMDXComponent=!0},179:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=a.a.createContext({}),p=function(e){var t=a.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):b(b({},t),e)),n},s=function(e){var t=p(e.components);return a.a.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},O=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,c=e.parentName,i=o(e,["components","mdxType","originalType","parentName"]),s=p(n),O=r,m=s["".concat(c,".").concat(O)]||s[O]||d[O]||l;return n?a.a.createElement(m,b(b({ref:t},i),{},{components:n})):a.a.createElement(m,b({ref:t},i))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,c=new Array(l);c[0]=O;var b={};for(var o in t)hasOwnProperty.call(t,o)&&(b[o]=t[o]);b.originalType=e,b.mdxType="string"==typeof e?e:r,c[1]=b;for(var i=2;i<l;i++)c[i]=n[i];return a.a.createElement.apply(null,c)}return a.a.createElement.apply(null,n)}O.displayName="MDXCreateElement"}}]);